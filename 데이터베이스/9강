01 정규화의 개념과 이상 현상

1) 정규화의 개념

정규화는 데이터베이스를 설계한 후 설계 결과물을 검증하기 위해 사용하기도 한다.



데이터베이스를 잘못 설계하면 불필요한 데이터 중복이 발생하여 릴레이션에 대한 데이터의 삽입, 수정, 삭제 연산을 수행할 때 부작용이 발생할 수 있다. 이러한 이상현상을 올바르게 설계하는 것이 정규화라고 한다.



2)이상 현상의 종류

삽입 이상: 새 데이터를 삽입하기 위해 불필요한 데이터도 함께 삽입해야 하는 문제

갱신 이상: 중복 투플 중 일부만 변경하여 데이터가 불일치하게 되는 모순의 문제

삭제 이상: 투플을 삭제하면 꼭 필요한 데이터까지 함께 삭제되는 데이터 손실의 문제



2.1) 삽입 이상

고객 아이디가 중복이 된다면, 구별을 위해 중복을 위한 새로운 데이터가 필요로 해진다.



2.2) 갱신 이상

중복된 투플들 중 일부만 수정하여 데이터가 불일치하게 되는 모순



2.3) 삭제 이상

투플을 삭제하면 꼭 필요한 데이터까지 함께 삭제되는 데이터 손실의 문제



3) 정규화의 필요성

관련 없는 속성들을 하나의 릴레이션에 모아두고 있기 때문에 이상현상이 발생한다.

릴레이션을 관련있는 속성들끼리만 구성하기 위해 릴레이션을 분해하는 과정이다.





02 함수 종속

X에 대한 Y값이 항상 하나다.

X->Y

X가 Y를 함수적으로 결정한다.

Y가 X에 함수적으로 종속되어 있다.

X 결정자, Y 종속자



함수 종속 관계를 판단할 때 유의할 점은, 현재 시점에 릴레이션에 포함된 속성 값만으로 판단하면 안 된다는 것이다.

릴레이션에서 속성 값은 계속 변할 수 있기 때문에 속성 자체가 가지고 있는 특성과 의미를 기반으로 판단해야 한다.



완전 함수 종속: 릴레이션에서 속성 집합 Y가 속성 집합 X에 함수적으로 종속되어 있지만, 속성 집합 X 전체에 종속된 것이지 일부에 종속된 것이 아님을 의미한다.



부분 함수 종속: 속성 집합 Y가 속성 집합 X의 전체가 아닌 일부분에도 함수적으로 종속됨을 의미하므로, 부분 함수 종속 관계가 성립하려면 결정자가 여러 개의 속성들로 구성되어야 한다.



일반적으로 함수 종속은 완전 함수 종속을 의미한다.



03 기본 정규형과 정규화 과정



1) 정규화의 개념과 정규형의 종류



릴레이션의 정규화된 정도는 정규형(NF: Normal Form)으로 표현한다. 

각 정규형마다 만족시켜야하는 제약조건이 존재한다. 특히 정규형의 제약조건을 만족하면 해당 정규형에 속한다고 표현한다.

차수가 높은 정규형에 속하는 릴레이션일수록 중복이 줄어 데이터 중복에 의한 이상 현상이 발생하지 않는 바람직한 릴레이션일 수 있다.



2) 제1 정규형



릴레이션에 속한 모든 속성의 도메인이 원자 값으로만 구성되어 있으면 제 1정규형에 속한다.



한 셀에 하나의 값만 있다.



삽입이상

이벤트참여 릴레이션이 있다고 하면, 고객아이디와 이벤트번호가 기본키이다. 이 때, 이벤트에 참여하지 않는다면 기본키가 없어 개체 무결성 제약조건을 위반한다.



경신이상

등급만 바꾸고 할인율을 안 바꾸면 데이터 일관성 유지 불가



삭제이상

처음 삭제이상의 설명과 같다.





3) 제 2 정규형

릴레이션이 제 1 정규형에 속하고 기본키가 아닌 모든 속성이 기본키에 완전 함수 종속되면 제 2정규형에 속한다.



릴레이션이 의미상 동등한 릴레이션으로 분해되어야 하고, 릴레이션을 분해했을 때 정보 손실이 발생하지 않아야한다.

무손실분해(nonloss decomposition): 정보손실이 없는 릴레이션 분해



삽입 이상

고객아이디가 없으면 새로운 등급과 할인율을 삽입할 수 없다.



갱신 이상

하나를 바꿀 때 안 바뀌는 것이 있다.



삭제 이상

하나만 있는 거 지우면 다른 데이터도 삭제된다.





제3 정규형

릴레이션이 제 2정규형에 속하고, 기본키가 아닌 모든 속성이 기본키에 이행적 함수 종속이 되지 않으면 제 3정규형에 속한다.



이행적 함수 종속(transitive FD)

X->Y, Y->Z

=X->Z



5) 보이스코드 정규형(BCNF; Boyce/Codd Normal Form)

릴레이션 함수 종속 관계에서 모든 결정자가 후보키이면 보이스/코드 정규형에 속한다.



릴레이션에서 기본키와 후보키가 여러개일 경우 제3정규형까지 모두 만족하더라도 이상 현상이 발생할 수 있다. 



후보키가 아닌 것을 제거한다.





6) 제 4정규형과 제 5정규형

제4정규형은 리레이션이 보이스/코드 정규형을 만족하면서, 함수 종속이 아닌 다치 종속을 제거해야 만족할 수 있다.

제5정규형은 제4정규형을 만족하면서 후보키를 통하지 않는 조인 종속을 제거해야 만족할 수 있다.



->자세한 설명은 생략한다고 한다.



7) 정규화 과정 정리

비정규형릴레이션->제1->제2>-제3>보이스코드



